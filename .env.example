# =============================================================================
# Company Intel Bot — Environment Variables
# Copy this file to .env and fill in all CHANGEME values.
# NEVER commit .env to git.
# =============================================================================

# -----------------------------------------------------------------------------
# General
# -----------------------------------------------------------------------------
NODE_ENV=development
LOG_LEVEL=info

# -----------------------------------------------------------------------------
# Database (PostgreSQL 16)
# Runs in Docker via: make docker-dev
# -----------------------------------------------------------------------------
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=company_intel_dev
POSTGRES_USER=intel
POSTGRES_PASSWORD=intel_dev_pass

# Full DSN used by Prisma — must match values above
DATABASE_URL="postgresql://intel:intel_dev_pass@localhost:5432/company_intel_dev?schema=public"

# -----------------------------------------------------------------------------
# Redis (BullMQ job queue)
# Runs in Docker via: make docker-dev
# -----------------------------------------------------------------------------
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_URL="redis://localhost:6379"

# -----------------------------------------------------------------------------
# Encryption (AES-256-GCM)
# Used to encrypt integration API keys stored in the database.
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# ⚠️  KEEP THIS SAFE — losing it means losing access to all encrypted configs
# -----------------------------------------------------------------------------
ENCRYPTION_KEY=CHANGEME_64_hex_chars_32_bytes_key_here

# -----------------------------------------------------------------------------
# JWT Auth
# Generate secrets with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
# -----------------------------------------------------------------------------
JWT_ACCESS_SECRET=CHANGEME_jwt_access_secret_here
JWT_REFRESH_SECRET=CHANGEME_jwt_refresh_secret_here
JWT_ACCESS_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# -----------------------------------------------------------------------------
# API (NestJS) — runs on port 3001
# -----------------------------------------------------------------------------
PORT=3001

# CORS — comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:3000,https://cslai.corporatespec.com

# Rate limiting (per IP, per window)
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=60

# -----------------------------------------------------------------------------
# Admin UI (Next.js) — runs on port 3000
# The public API URL is used by the browser to make API calls.
# -----------------------------------------------------------------------------
NEXT_PUBLIC_API_URL=http://localhost:3001
# Production:
# NEXT_PUBLIC_API_URL=https://api.cslai.corporatespec.com

# -----------------------------------------------------------------------------
# Slack Integration
# Obtain from: https://api.slack.com/apps → Your App → Basic Information
# Per-tenant tokens are stored encrypted in the database via the Admin UI.
# -----------------------------------------------------------------------------
SLACK_SIGNING_SECRET=CHANGEME_slack_signing_secret
SLACK_BOT_TOKEN=xoxb-CHANGEME

# -----------------------------------------------------------------------------
# LLM Providers
# These are default/fallback keys for development.
# In production, keys are entered per-tenant via the Admin UI and stored
# encrypted in the database.
# -----------------------------------------------------------------------------

# Provider to use: openai | anthropic | gemini
DEFAULT_LLM_PROVIDER=openai
DEFAULT_LLM_MODEL=gpt-4o

OPENAI_API_KEY=sk-CHANGEME
OPENAI_MODEL=gpt-4o-mini

ANTHROPIC_API_KEY=sk-ant-CHANGEME
ANTHROPIC_MODEL=claude-3-5-haiku-20241022

GOOGLE_GEMINI_API_KEY=CHANGEME
GEMINI_MODEL=gemini-1.5-flash

# -----------------------------------------------------------------------------
# BullMQ Worker
# -----------------------------------------------------------------------------
WORKER_CONCURRENCY=5
ENRICHMENT_JOB_TIMEOUT_MS=120000
ENRICHMENT_JOB_MAX_ATTEMPTS=3
ENRICHMENT_JOB_BACKOFF_DELAY_MS=5000

# -----------------------------------------------------------------------------
# Thread Memory
# -----------------------------------------------------------------------------
MEMORY_MAX_TURNS=20
MEMORY_MAX_CHARS=12000
MEMORY_SUMMARIZE_THRESHOLD_TURNS=15

# -----------------------------------------------------------------------------
# Seed / Super-Admin (used only by make seed)
# -----------------------------------------------------------------------------
SEED_ADMIN_EMAIL=admin@example.com
SEED_ADMIN_PASSWORD=CHANGEME_admin_password
SEED_TENANT_NAME=Default Tenant
